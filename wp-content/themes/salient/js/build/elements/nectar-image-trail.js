!function(){"use strict";const e=document.body,t={lerp:(e,t,s)=>e+(t-e)*s,distance:(e,t,s,i)=>Math.hypot(s-e,i-t)},s=t=>{let s=0,i=0;return t||(t=window.event),t.pageX||t.pageY?(s=t.pageX,i=t.pageY):(t.clientX||t.clientY)&&(s=t.clientX+e.scrollLeft,i=t.clientY+e.scrollTop),{x:s,y:i}};class i{constructor(e){this.el=e,this.referenceImages=[],[...this.el.querySelectorAll(".nectar-image-trail__list img")].forEach(e=>{this.referenceImages.push({src:void 0!==e.dataset.nectarImgSrc&&null!==e.dataset.nectarImgSrc?e.dataset.nectarImgSrc:e.src})}),this.referenceImagesTotal=this.referenceImages.length,this.imgPosition=0,this.zIndexVal=1,this.threshold=void 0!==this.el.dataset.frequency&&null!==this.el.dataset.frequency?this.el.dataset.frequency:100,this.threshold=parseFloat(this.threshold),this.duration=void 0!==this.el.dataset.duration&&null!==this.el.dataset.duration?this.el.dataset.duration:1,this.duration=1e3*parseFloat(this.duration),this.randomize="true"===this.el.dataset.randomize,this.randomizeRotation=void 0!==this.el.dataset.randomizeRotation&&null!==this.el.dataset.randomizeRotation&&this.el.dataset.randomizeRotation,this.randomizeRotation="true"===this.randomizeRotation,this.lerp=void 0!==this.el.dataset.lerp&&null!==this.el.dataset.lerp?this.el.dataset.lerp:70,this.lerp=Math.max(parseFloat((100-this.lerp)/100),.1),this.mousePos={x:0,y:0},this.lastMousePos={x:0,y:0},this.cacheMousePos={x:0,y:0},this.animating=!1,this.animationIn=this.el.dataset.animationIn||"none",this.animationOut=this.el.dataset.animationOut||"none",this.styleSettings={none:{in:{opacity:{value:1,duration:0,easing:"easeOutExpo"}},out:{opacity:{value:0,easing:"easeOutQuad",duration:0}}},scale:{in:{opacity:{value:[0,1],duration:200,easing:"easeOutCubic"},scale:{value:[0,1],duration:400,easing:"easeOutCubic"}},out:{opacity:0,scale:.5,easing:"easeInOutCubic",duration:350}},circle_mask:{in:{opacity:{value:[0,1],duration:200,easing:"easeOutCubic"},clipPath:{value:["circle(0% at 50% 50%)","circle(75% at 50% 50%)"],duration:650,easing:"easeOutCubic"}},out:{opacity:0,easing:"easeInOutCubic",duration:350}},fade:{in:{opacity:{value:[0,1],duration:400,easing:"easeOutCubic"}},out:{opacity:0,easing:"easeOutCubic",duration:400}}},this.renderedImages=[],this.referenceImagesTotal>20?this.maxRenderedImages=this.referenceImagesTotal:this.referenceImagesTotal<15?this.maxRenderedImages=2*this.referenceImagesTotal:this.maxRenderedImages=20,this.el.addEventListener("mousemove",e=>{this.mousePos=s(e)}),this.isVisible=!1,this.observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting?(this.isVisible=!0,this.animating||(this.animating=!0,this.render())):(this.isVisible=!1,this.animating=!1)})},{threshold:0}),this.observer.observe(this.el)}render(){if(!this.isVisible)return;let e=t.distance(this.mousePos.x,this.mousePos.y,this.lastMousePos.x,this.lastMousePos.y);this.cacheMousePos.x=t.lerp(this.cacheMousePos.x||this.mousePos.x,this.mousePos.x,this.lerp),this.cacheMousePos.y=t.lerp(this.cacheMousePos.y||this.mousePos.y,this.mousePos.y,this.lerp),e>this.threshold&&(this.randomize?this.imgPosition=Math.floor(Math.random()*this.referenceImagesTotal):this.imgPosition=this.imgPosition<this.referenceImagesTotal-1?this.imgPosition+1:0,this.showNextImage(),++this.zIndexVal,this.lastMousePos=Object.assign({},this.mousePos)),requestAnimationFrame(()=>this.render())}showNextImage(){const e=this.referenceImages[this.imgPosition],t=document.createElement("img");t.className="nectar-image-trail__image",t.src=e.src,t.style.width=e.width+"px",t.style.height=e.height+"px";const s=this.el.querySelector(".nectar-image-trail__list img:nth-child("+(this.imgPosition+1)+")");if(s&&t.classList.add(...s.classList),this.el.appendChild(t),this.renderedImages.push(t),this.renderedImages.length>this.maxRenderedImages){const e=this.renderedImages.shift();e&&e.parentNode&&e.remove()}const i=t.getBoundingClientRect();let a;anime.remove(t),anime.set(t,{opacity:0,zIndex:this.zIndexVal,translateX:this.cacheMousePos.x-i.width/2,translateY:this.cacheMousePos.y-i.height/2,scale:1,rotate:!0===this.randomizeRotation?60*Math.random()-30:0}),this.duration>=.9?a=300:this.duration<=.5?a=100:(a=100+(this.duration-.5)/.4*200,a=Math.round(a)),anime.timeline().add({targets:t,...this.styleSettings[this.animationIn].in,translateX:{value:this.mousePos.x-i.width/2,duration:this.duration,easing:"easeOutExpo"},translateY:{value:this.mousePos.y-i.height/2,duration:this.duration,easing:"easeOutExpo"}}).add({targets:t,...this.styleSettings[this.animationOut].out,complete:()=>{t.remove();const e=this.renderedImages.indexOf(t);-1!==e&&this.renderedImages.splice(e,1)}},`-=${a}`)}}let a=[];function n(){a=[];const e=document.querySelectorAll(".nectar-image-trail");0!==e.length&&e.forEach((e,t)=>{a[t]=new i(e)})}document.addEventListener("DOMContentLoaded",n),jQuery(window).on("vc_reload",()=>{setTimeout(n,200)})}();